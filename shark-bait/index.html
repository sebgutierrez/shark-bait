<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <script src="https://worldwind.arc.nasa.gov/web/worldwind.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/node_modules/@cesium/engine/Source/Widgets/widgets.css">
    <title>Shark Bait</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
    <!-- <script>
        // Shark tracking data
        const sharkData = [
            {dataset: "ACT.BKTIP", species: "blacktip shark", scientific: "Carcharhinus limbatus", lat: 37.11138, lon: -75.702383},
            {dataset: "ACT.BKTIP", species: "blacktip shark", scientific: "Carcharhinus limbatus", lat: 33.88375, lon: -77.99878},
            {dataset: "ACT.BKTIP", species: "blacktip shark", scientific: "Carcharhinus limbatus", lat: 36.67747, lon: -75.89253},
            {dataset: "ACT.BULLS", species: "bull shark", scientific: "Carcharhinus leucas", lat: 32.4354, lon: -80.3879},
            {dataset: "ACT.BULLS", species: "bull shark", scientific: "Carcharhinus leucas", lat: 35.40852, lon: -76.0107},
            {dataset: "ACT.BULLS", species: "bull shark", scientific: "Carcharhinus leucas", lat: 32.4354, lon: -80.3879},
            {dataset: "ACT.BULLS", species: "bull shark", scientific: "Carcharhinus leucas", lat: 35.6017, lon: -75.865},
            {dataset: "SAF.POZS", species: "bull shark / Zambezi shark", scientific: "Carcharhinus leucas", lat: 32.9, lon: -26.84},
            {dataset: "SAF.POZS", species: "bull shark / Zambezi shark", scientific: "Carcharhinus leucas", lat: 32.93627778, lon: -26.75558333},
            {dataset: "SAF.POZS", species: "bull shark / Zambezi shark", scientific: "Carcharhinus leucas", lat: 32.93784, lon: -26.75198},
            {dataset: "SAF.POZS", species: "bull shark / Zambezi shark", scientific: "Carcharhinus leucas", lat: 30.82757, lon: -30.24398},
            {dataset: "SAF.POZS", species: "tiger shark", scientific: "Galeocerdo cuvier", lat: 32.9, lon: -26.84},
            {dataset: "SAF.POZS", species: "tiger shark", scientific: "Galeocerdo cuvier", lat: 32.83314, lon: -27.15556},
            {dataset: "SAF.POZS", species: "tiger shark", scientific: "Galeocerdo cuvier", lat: 32.93784, lon: -26.75198},
            {dataset: "SAF.POZS", species: "tiger shark", scientific: "Galeocerdo cuvier", lat: 32.93627778, lon: -26.75558333},
            {dataset: "SAF.POZS", species: "tiger shark", scientific: "Galeocerdo cuvier", lat: 32.9297, lon: -26.78906},
            {dataset: "SAF.SSST", species: "white shark", scientific: "Carcharodon carcharias", lat: 20.05003, lon: -34.77177},
            {dataset: "SAF.SSST", species: "white shark", scientific: "Carcharodon carcharias", lat: 18.57027, lon: -34.12312},
            {dataset: "SAF.SSST", species: "white shark", scientific: "Carcharodon carcharias", lat: 19.41861, lon: -34.62888},
            {dataset: "SAF.SSST", species: "white shark", scientific: "Carcharodon carcharias", lat: 18.623945, lon: -34.079114},
            {dataset: "SAF.SSST", species: "white shark", scientific: "Carcharodon carcharias", lat: 18.589669, lon: -34.132669},
            {dataset: "SAF.SSST", species: "smoothhound shark", scientific: "Mustelus mustelus", lat: 18.68783, lon: -34.07671},
            {dataset: "SAF.SSST", species: "sevengill shark", scientific: "Notorynchus cepedianus", lat: 18.397383, lon: -33.82125},
            {dataset: "SAF.SSST", species: "sevengill shark", scientific: "Notorynchus cepedianus", lat: 18.57027, lon: -34.12312},
            {dataset: "SAF.SSST", species: "sevengill shark", scientific: "Notorynchus cepedianus", lat: 18.518072, lon: -34.349615}
        ];

        // Color mapping by species
        function getColorForSpecies(species) {
            const lower = species.toLowerCase();
            if (lower.includes('white')) return '#ff4444';
            if (lower.includes('tiger')) return '#ff8800';
            if (lower.includes('bull') || lower.includes('zambezi')) return '#4444ff';
            if (lower.includes('blacktip')) return '#00aa00';
            if (lower.includes('sevengill')) return '#aa00aa';
            return '#888888';
        }

        // Create features from shark data
        const features = sharkData.map((shark, idx) => {
            const feature = new ol.Feature({
                geometry: new ol.geom.Point(
                    ol.proj.fromLonLat([shark.lon, shark.lat])
                ),
                species: shark.species,
                scientific: shark.scientific,
                dataset: shark.dataset,
                latitude: shark.lat,
                longitude: shark.lon
            });

            const color = getColorForSpecies(shark.species);
            
            feature.setStyle(new ol.style.Style({
                image: new ol.style.Circle({
                    radius: 7,
                    fill: new ol.style.Fill({ color: color }),
                    stroke: new ol.style.Stroke({
                        color: '#ffffff',
                        width: 2
                    })
                })
            }));

            return feature;
        });

        // Create vector source and layer
        const vectorSource = new ol.source.Vector({
            features: features
        });

        const vectorLayer = new ol.layer.Vector({
            source: vectorSource
        });

        // Create the map
        const map = new ol.Map({
            target: 'map',
            layers: [
                new ol.layer.Tile({
                    source: new ol.source.OSM()
                }),
                vectorLayer
            ],
            view: new ol.View({
                center: ol.proj.fromLonLat([0, 0]),
                zoom: 2
            })
        });

        // Fit map to show all markers
        const extent = vectorSource.getExtent();
        map.getView().fit(extent, { padding: [50, 50, 50, 250], maxZoom: 10 });

        // Create popup element
        const popup = document.createElement('div');
        popup.className = 'marker-popup';
        popup.style.display = 'none';
        popup.style.position = 'absolute';
        document.body.appendChild(popup);

        // Handle click events
        map.on('click', function(evt) {
            const feature = map.forEachFeatureAtPixel(evt.pixel, function(feature) {
                return feature;
            });

            if (feature) {
                const coords = map.getPixelFromCoordinate(feature.getGeometry().getCoordinates());
                popup.innerHTML = `
                    <div class="popup-species">${feature.get('species')}</div>
                    <div class="popup-scientific">${feature.get('scientific')}</div>
                    <div class="popup-coords">
                        Lat: ${feature.get('latitude').toFixed(4)}°<br>
                        Lon: ${feature.get('longitude').toFixed(4)}°
                    </div>
                    <div class="popup-dataset">Dataset: ${feature.get('dataset')}</div>
                `;
                popup.style.left = coords[0] + 'px';
                popup.style.top = (coords[1] - 100) + 'px';
                popup.style.display = 'block';
            } else {
                popup.style.display = 'none';
            }
        });

        // Change cursor on hover
        map.on('pointermove', function(evt) {
            const pixel = map.getEventPixel(evt.originalEvent);
            const hit = map.hasFeatureAtPixel(pixel);
            map.getTarget().style.cursor = hit ? 'pointer' : '';
        });
    </script> -->
  </body>
</html>
